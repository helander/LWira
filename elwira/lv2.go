// =====================================================================================================
// File:           lv2.go
// Project:        elvira
// Author:         Lars-Erik Helander <lehswel@gmail.com>
// License:        MIT
// Description:    Web server service handlers
// =====================================================================================================

package main

import (
	"net/http"

        "elwira/lilv"
)

// =====================================================================================================
// Types & constants
// =====================================================================================================

// =====================================================================================================
// Local state
// =====================================================================================================

// =====================================================================================================
// Local functions
// =====================================================================================================

// =====================================================================================================
// PluginsHandler
// =====================================================================================================
func PluginsHandler(w http.ResponseWriter, r *http.Request) {
    if r.Method != http.MethodGet {
        http.Error(w, "Method not allowed", http.StatusMethodNotAllowed)
        return
    }
    lilv.Plugins(w)
}

// =====================================================================================================
// PresetsHandler
// =====================================================================================================
func PresetsHandler(w http.ResponseWriter, r *http.Request) {
    if r.Method != http.MethodGet {
        http.Error(w, "Method not allowed", http.StatusMethodNotAllowed)
        return
    }

    uriParam := r.URL.Query().Get("uri")
    if uriParam == "" {
        http.Error(w, "Missing 'uri' parameter", http.StatusBadRequest)
        return
    }

    lilv.Presets(w,uriParam)
}

// =====================================================================================================
// Init
// =====================================================================================================
func init() {
        http.HandleFunc("/plugins", PluginsHandler)
        http.HandleFunc("/presets", PresetsHandler)
}

